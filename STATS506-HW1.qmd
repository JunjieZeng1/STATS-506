---
title: "STATS506-HW1-JunjieZeng"
author: "Junjie Zeng"
format: html
editor: visual
---

# STATS506 Problem Set #1

## Problem 1 - Wine Data

### 1.a

```{r}
# Loading data
dfwine <- read.table("/Users/junjiezeng/Desktop/wine/wine.data", sep = ",")
```

```{r}
# Change column names
names(dfwine) <- c("class", "Alcohol", "Malicacid", "Ash", "Alcalinity_of_ash", "Magnesium", "Total_phenols", "Flavanoids", "Nonflavanoid_phenols", "Proanthocyanins","Color_intensity", "Hue", "OD280_OD315_of_diluted_wines", "Proline")
head(dfwine)
```

### 1.b

The number of wines within each class indeed matches the numbers reported in "wine.names", which are 59, 71, and 48 respectively.

```{r}
# Create new dataframes for different classes
dfwine1 <- dfwine[dfwine$class == 1, ]
dfwine2 <- dfwine[dfwine$class == 2, ]
dfwine3 <- dfwine[dfwine$class == 3, ]
```

```{r}
# Check the number of wines within each class
nrow(dfwine1)
nrow(dfwine2)
nrow(dfwine3)
```

### 1.c

#### 1.c.1

The correlation between alcohol content and color intensity is `cor(dfwine$Alcohol, dfwine$Color_intensity)`

```{r}
# Compute the correlation of alcohol vs color intensity
cor(dfwine$Alcohol, dfwine$Color_intensity)
```

#### 1.c.2

Class 1 has the highest correlation, which is 0.4082913. Class 2 has the lowest correlation, which is 0.2697891.

```{r}
# Compute correlation above for different classes
cor1 <- cor(dfwine1$Alcohol, dfwine1$Color_intensity)
cor2 <- cor(dfwine2$Alcohol, dfwine2$Color_intensity)
cor3 <- cor(dfwine3$Alcohol, dfwine3$Color_intensity)
cor1
cor2
cor3
```

```{r}
# Find the highest and lowest correlation
cors <- c(cor1, cor2, cor3)
max(cors)
min(cors)
```

#### 1.c.3

The alcohol content of the wine with the highest color intensity is 14.34.

```{r}
dfwine[dfwine$Color_intensity == max(dfwine$Color_intensity),]$Alcohol
```

#### 1.c.4
About 8.43 percent of wines had a higher content of proanthocyanins compare to ash. 
```{r}
# Computing percentage
nrow(dfwine[dfwine$Proanthocyanins - dfwine$Ash > 0,]) / nrow(dfwine)
```



### 1.d
```{r}
# Compute averages
mean_var <- rep(NA, 13)
mean_var1 <- rep(NA, 13)
mean_var2 <- rep(NA, 13)
mean_var3 <- rep(NA, 13)

for (i in 2:ncol(dfwine)){
  mean_var[i - 1] = mean(dfwine[, i])
  mean_var1[i - 1] = mean(dfwine[dfwine$class == 1, i])
  mean_var2[i - 1] = mean(dfwine[dfwine$class == 2, i])
  mean_var3[i - 1] = mean(dfwine[dfwine$class == 3, i])
}

mean_var
mean_var1
mean_var2
mean_var3
```

```{r}
# Create a table
df_mean <- t(data.frame(overall_mean = mean_var,
                    class1_mean = mean_var1,
                    class2_mean = mean_var2,
                    class3_mean = mean_var3))
table_mean <- as.table(df_mean)
colnames(table_mean) <- colnames(dfwine[,-1])
```
```{r}
table_mean
```

### 1.e
Both t-test result rejected the null hypothesis with very small p-values, suggesting the level of phenols differs across the three classes. 
```{r}
t.test(dfwine1$Total_phenols, dfwine2$Total_phenols)
t.test(dfwine2$Total_phenols, dfwine3$Total_phenols)
```

## Problem 2
### 2.a
```{r}
# Import data
dfmanager <- read.table("AskAManager.csv", sep = ",", header = TRUE)
```

### 2.b
```{r}
# Set column names
colnames(dfmanager) <- c("Number", "Timestamp", "Age", "Industry", "Position", "Position_supplement", "Salary", "Additional_compensation", "Currency", "Other_currency", "Income_supplement", "Country", "State", "City", "Overall_work_years", "Field_work_years", "Level_of_education", "Gender", "Race")
```

### 2.c
```{r}
# Filter out those being paid in US dollars (USD)
nrow(dfmanager)
dfmanager_usd <- dfmanager[dfmanager$Currency == "USD", ]
nrow(dfmanager_usd)
```

### 2.d
```{r}
unique(dfmanager$Age)
unique(dfmanager$Overall_work_years)
unique(dfmanager$Field_work_years)
```
```{r}
dfmanager_usd <- dfmanager_usd[!(dfmanager_usd$Age == "under 18"), ]
```


```
